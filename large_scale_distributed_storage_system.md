《大规模分布式存储系统》
=======================

## 作者
   杨传辉  
  
## 简介
> 《大规模分布式存储系统：原理解析与架构实战》是分布式系统领域的经典著作，由阿里巴巴高级技术专家“阿里日照”（OceanBase核心开发人员）撰写，阳振坤、章文嵩、杨卫华、汪源、余锋（褚霸）、赖春波等来自阿里、新浪、网易和百度的资深技术专家联袂推荐。理论方面，不仅讲解了大规模分布式存储系统的核心技术和基本原理，而且对谷歌、亚马逊、微软和阿里巴巴等国际型大互联网公司的大规模分布式存储系统进行了分析；实战方面，首先通过对阿里巴巴的分布式数据库OceanBase的实现细节的深入剖析完整地展示了大规模分布式存储系统的架构与设计过程，然后讲解了大规模分布式存储技术在云计算和大数据领域的实践与应用。
《大规模分布式存储系统：原理解析与架构实战》内容分为四个部分：基础篇——分布式存储系统的基础知识，包含单机存储系统的知识，如数据模型、事务与并发控制、故障恢复、存储引擎、压缩/解压缩等；分布式系统的数据分布、复制、一致性、容错、可扩展性等。范型篇——介绍谷歌、亚马逊、微软、阿里巴巴等著名互联网公司的大规模分布式存储系统架构，涉及分布式文件系统、分布式键值系统、分布式表格系统以及分布式数据库技术等。实践篇——以阿里巴巴的分布式数据库OceanBase为例，详细介绍分布式数据库内部实现，以及实践过程中的经验。专题篇——介绍分布式系统的主要应用：云存储和大数据，这些是近年来的热门领域，本书介绍了云存储平台、技术与安全，以及大数据的概念、流式计算、实时分析等。

## 作者简介
> 杨传辉，阿里巴巴高级技术专家，花名日照，OceanBase核心开发人员，对分布式系统的理论和工程实践有深刻理解。曾在百度作为核心成员参与类MapReduce系统、类Bigtable系统和百度分布式消息队列等底层基础设施架构工作。热衷于分布式存储和计算系统设计，乐于分享，有技术博客NosqlNotes。

## 豆瓣链接
[豆瓣链接](https://book.douban.com/subject/25723658/)

## 目录

## 内容

#### 第1章 概述
* 分布式存储系统是大量普通PC服务器通过网络，对外作为一个整体提供存储服务
  - 特点：可扩展、低成本、高性能、易用
  - 涉及技术：数据分布、一致性、容错、负载均衡、事务与并发控制、易用性、压缩/解压缩
* 分布式存储数据分类
  - 非结构化数据（文档、文本、图片、音频、视频）
  - 结构化数据（关系数据库中的数据）
  - 半结构化数据（HTML文档）
* 分布式存储系统分类：文件系统、键值系统、表格系统、数据库

#### 第2章 单机存储系统
* 单机存储引擎就是哈希表、B树等数据结构在机械磁盘、SSD等持久化介质上的实现
* CPU架构：散热问题-》多核
* IO总线：存储系统的性能瓶颈一般在于IO
* 常见硬件的性能参数
* 并发控制
  - 数据库锁：读锁、写锁
    - 同一元素允许加多个读锁，但只允许一个写锁，且写事务阻塞读事务
    - 解决死锁：事务超时回滚 或 死锁检测（依赖环路）并回滚
  - 写时复制（Copy on Write）
    - 提高读取性能（读不加锁）；写操作成本高且互斥
  - 多版本并发控制 
    - 对每行数据维护多个版本
    - InnoDB引擎，对第一行维护两个隐含列（修改时间、删除时间-版本号）
* 故障恢复
  - 操作日志：回滚日志、重做日志、REDO日志
    - 事务T对X=5加10：UNDO日志<T,X,5>，REDO日志<T,X,15>，UNDO/REDO日志<T,X,5,15>
* 数据压缩：有损压缩、无损压缩
  - 算法：Huffman编码、LZ算法（基于字典）、BMDiff与Zippy
* 列式存储：适用于OLAP类型（将同数据列的值放在一起）
  - 同列数据重复度高，适合压缩
  
#### 第3章 分布式系统
* 章节内容：基础概念和性能估算方法、理论知识（分布、复制、一致性、容错）、分布式协议
* 基本概念
  - 异常：服务器宕机、网络异常、磁盘故障（磁盘损坏、数据错误）
  - 超时：分布式系统请求结果：成功、失败、超时
  - 一致性：副本是容错技术的唯一手段，分为强一致性、弱一致性、最终一致性
  - 衡量指标
    - 性能：吞吐能力(QPS|TPS)、响应时间
    - 可用性：4个9即停止服务时间不超过52分钟
    - 一致性：
    - 可扩展性：通过扩展规模提高性能
* 数据分布
  - 哈希分布：破坏了数据的有序性，只支持随机读取
    - 根据用户ID散列，容易出现数据倾斜（解决：手动拆分、自动拆分）、服务器数量变化时，需要迁移大量数据
  - 顺序分布：
  - 负载均衡：集群中一个总控节点，其它为工作节点
* 复制
  - 数据副本分为一个主副本(Primary)其它为备副本(Backup)
  - 复制协议：强同步复制（写请求需要同步备副本才返回成功）、异步复制
  - 概述
    - 强同步复制：写请求到主副本，主副本同步操作日志到备副本，备副本回放日志，通知主副本，主副本修改本机，返回成功
  - CAP（一致性、可用性、分区可容忍性 三者不能同时满足）
* 容错
  - 单机故障和磁盘故障发生概率最高
  - 心跳检测、租约到期
